<!-- HEADER -->
<header class="w-full bg-white border-b shadow-sm fixed top-0 left-0 z-50">
  <div class="max-w-xl mx-auto px-4 py-3 text-center font-semibold text-lg">
    üçΩ Go-Dutch | ‡πÅ‡∏ä‡∏£‡πå‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£
  </div>
</header>

<!-- MAIN -->
<main class="pt-[60px] pb-[70px] max-w-xl mx-auto px-4 space-y-6 text-sm sm:text-base">

  <!-- ‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏à‡πà‡∏≤‡∏¢ -->
  <section>
    <h2 class="text-base font-semibold mb-3">üë• ‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏à‡πà‡∏≤‡∏¢</h2>
    <div class="space-y-2">
      <div class="flex items-center gap-2" *ngFor="let payer of payers; let i = index">
        <mat-form-field appearance="outline" class="flex-1">
          <input matInput [(ngModel)]="payer.name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà {{ i + 1 }}" />
        </mat-form-field>
        <button mat-icon-button color="warn" (click)="removePayer(i)" *ngIf="payers.length > 1">
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>
    <button mat-stroked-button class="mt-3 w-full" (click)="addPayer()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ô</button>
  </section>

  <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£ -->
  <section>
    <h2 class="text-base font-semibold mb-3">üç± ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h2>
    <div *ngFor="let item of items; let i = index" class="rounded border border-gray-200 p-4 mb-4 bg-white space-y-3">
      <mat-form-field appearance="outline" class="w-full">
        <input matInput [(ngModel)]="item.name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£" />
      </mat-form-field>
      <mat-form-field appearance="outline" class="w-full">
        <input matInput type="number" [(ngModel)]="item.price" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)" />
      </mat-form-field>
      <mat-form-field appearance="outline" class="w-full">
        <mat-select [(ngModel)]="item.paidBy" placeholder="‡πÉ‡∏Ñ‡∏£‡∏à‡πà‡∏≤‡∏¢">
          <mat-option *ngFor="let payer of payers; trackBy: trackByName" [value]="payer.name">
            {{ payer.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <div>
        <label class="text-xs text-gray-500">‡∏´‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡πÉ‡∏Ñ‡∏£‡∏ö‡πâ‡∏≤‡∏á</label>
        <div class="flex flex-wrap gap-2 mt-1">
          <mat-checkbox *ngFor="let payer of payers" [(ngModel)]="item.splitWith[payer.name]">
            {{ payer.name }}
          </mat-checkbox>
        </div>
      </div>
      <div class="text-right">
        <button mat-button color="warn" (click)="removeItem(i)">‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
      </div>
    </div>
    <button mat-stroked-button class="w-full" (click)="addItem()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
  </section>

  <!-- ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î -->
  <section>
    <h2 class="text-base font-semibold mb-3">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î</h2>
    <div class="divide-y border border-gray-200 rounded bg-white">
      <div *ngFor="let payer of payers" class="flex justify-between px-4 py-2">
        <span>{{ payer.name }}</span>
        <span class="font-medium text-gray-700">
          {{ getAmountToPay(payer.name) | number:'1.2-2' }} ‡∏ø
        </span>
      </div>
    </div>
  </section>

  <!-- ‡πÇ‡∏≠‡∏ô‡∏Ñ‡∏∑‡∏ô -->
  <section>
    <h2 class="text-base font-semibold mb-3">üí∏ ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ä‡∏î‡πÉ‡∏ä‡πâ</h2>
    <div *ngIf="getTransferInstructions().length === 0" class="text-gray-500 italic">
      ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô üéâ
    </div>
    <div *ngFor="let t of getTransferInstructions()" class="flex justify-between px-4 py-2 bg-green-50 border border-green-200 rounded mb-2">
      <div>{{ t.from }} ‚ûú {{ t.to }}</div>
      <div class="font-semibold text-green-800">{{ t.amount | number:'1.2-2' }} ‡∏ø</div>
    </div>
  </section>

  <!-- ‡πÅ‡∏ä‡∏£‡πå‡∏•‡∏¥‡∏á‡∏Å‡πå -->
  <section>
    <button mat-raised-button color="primary" class="w-full" (click)="shareLink()">
      üì§ ‡πÅ‡∏ä‡∏£‡πå‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô
    </button>
  </section>

  <!-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ -->
  <section class="mt-6 space-y-2">
    <h2 class="font-semibold">üßæ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ</h2>

    <mat-form-field appearance="outline" class="w-full">
      <input matInput placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÇ‡∏≠‡∏ô (‡∏à‡∏≤‡∏Å)" [(ngModel)]="testFrom" />
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <input matInput placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô (‡∏ñ‡∏∂‡∏á)" [(ngModel)]="testTo" />
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <input matInput type="number" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏≠‡∏ô" [(ngModel)]="testAmount" />
    </mat-form-field>

    <button mat-raised-button color="accent" (click)="verifySlip()">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ</button>

    <div *ngIf="slipResult !== null" class="text-sm mt-2 font-medium"
         [ngClass]="{ 'text-green-600': slipResult, 'text-red-600': !slipResult }">
      {{ slipResult ? '‚úÖ ‡πÇ‡∏≠‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥' : '‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥' }}
    </div>
  </section>

</main>
