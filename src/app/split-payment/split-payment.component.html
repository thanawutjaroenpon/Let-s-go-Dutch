<!-- HEADER -->
<header class="bg-white border-b sticky top-0 z-50">
  <div class="max-w-sm mx-auto px-4 py-3 text-center font-medium">
    üçΩ Go-Dutch
  </div>
</header>

<!-- MAIN -->
<main class="max-w-sm mx-auto px-4 py-4 space-y-4">

  <!-- ‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏à‡πà‡∏≤‡∏¢ -->
  <section class="bg-white rounded-xl p-4 shadow-sm">
    <h2 class="font-medium mb-3 flex items-center gap-2">
      <span>üë•</span>
      <span>‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏à‡πà‡∏≤‡∏¢</span>
    </h2>
    
    <div class="space-y-3">
      <div
        class="border rounded-lg p-3 relative"
        *ngFor="let payer of payers; let i = index"
      >
        <!-- Delete button -->
        <button
          *ngIf="payers.length > 1"
          (click)="removePayer(i)"
          class="absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full text-xs hover:bg-red-600"
        >
          √ó
        </button>

        <!-- Person number and name -->
        <div class="flex items-center gap-3 mb-3">
          <span class="w-7 h-7 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-medium">
            {{ i + 1 }}
          </span>
          <input
            [(ngModel)]="payer.name"
            placeholder="‡∏ä‡∏∑‡πà‡∏≠"
            class="flex-1 p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>

        <!-- Payment details -->
        <div class="space-y-2">
          <input
            [(ngModel)]="payer.scb"
            placeholder="SCB: xxx-x-xxxxx-x"
            class="w-full p-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <input
            [(ngModel)]="payer.promptpay"
            placeholder="PromptPay: ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£/‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô"
            class="w-full p-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>
      </div>
    </div>

    <button
      (click)="addPayer()"
      class="w-full mt-3 p-3 border-2 border-dashed border-blue-300 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors"
    >
      + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ô
    </button>
  </section>

  <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£ -->
  <section class="bg-white rounded-xl p-4 shadow-sm">
    <h2 class="font-medium mb-3 flex items-center gap-2">
      <span>üç±</span>
      <span>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£</span>
    </h2>
    
    <div class="space-y-3">
      <div
        *ngFor="let item of items; let i = index"
        class="border rounded-lg p-3 space-y-3 relative"
      >
        <!-- Delete button -->
        <button
          (click)="removeItem(i)"
          class="absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full text-xs hover:bg-red-600"
        >
          √ó
        </button>

        <!-- Item name -->
        <input
          [(ngModel)]="item.name"
          placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£"
          class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        />

        <!-- Price and payer -->
        <div class="grid grid-cols-2 gap-2">
          <input
            [(ngModel)]="item.price"
            type="number"
            placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤"
            class="p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <select
            [(ngModel)]="item.paidBy"
            class="p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          >
            <option value="">‡πÉ‡∏Ñ‡∏£‡∏à‡πà‡∏≤‡∏¢</option>
            <option *ngFor="let payer of payers; trackBy: trackByName" [value]="payer.name">
              {{ payer.name }}
            </option>
          </select>
        </div>

        <!-- Split with -->
        <div>
          <div class="text-sm text-gray-600 mb-2">‡∏´‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡πÉ‡∏Ñ‡∏£‡∏ö‡πâ‡∏≤‡∏á</div>
          <div class="grid grid-cols-2 gap-2">
            <label *ngFor="let payer of payers" class="flex items-center gap-2 text-sm">
              <input
                type="checkbox"
                [(ngModel)]="item.splitWith[payer.name]"
                class="rounded"
              />
              {{ payer.name }}
            </label>
          </div>
        </div>
      </div>
    </div>

    <button
      (click)="addItem()"
      class="w-full mt-3 p-3 border-2 border-dashed border-gray-300 text-gray-600 rounded-lg hover:bg-gray-50 transition-colors"
    >
      + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
    </button>
  </section>

  <!-- ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î -->
  <section class="bg-white rounded-xl p-4 shadow-sm">
    <h2 class="font-medium mb-3 flex items-center gap-2">
      <span>üìä</span>
      <span>‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î</span>
    </h2>
    
    <div class="space-y-2">
      <div *ngFor="let payer of payers" class="flex justify-between items-center py-2 border-b last:border-b-0">
        <span>{{ payer.name }}</span>
        <span class="font-medium text-green-600">
          {{ getAmountToPay(payer.name) | number:'1.2-2' }} ‡∏ø
        </span>
      </div>
    </div>
  </section>

<!-- ‡πÇ‡∏≠‡∏ô‡∏Ñ‡∏∑‡∏ô -->
<section class="bg-white rounded-xl p-4 shadow-sm">
  <h2 class="font-medium mb-3 flex items-center gap-2">
    <span>üí∏</span>
    <span>‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</span>
  </h2>
  
  <div *ngIf="getTransferInstructions().length === 0" class="text-gray-500 text-center py-4">
    ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß üéâ
  </div>
  
  <div class="space-y-4">
    <div
      *ngFor="let t of getTransferInstructions()"
      class="bg-green-50 border border-green-200 rounded-lg p-4"
    >
      <!-- Transfer amount -->
      <div class="flex justify-between items-center mb-3">
        <span class="text-sm font-medium">{{ t.from }} ‚Üí {{ t.to }}</span>
        <span class="font-bold text-green-700 text-lg">{{ t.amount | number:'1.2-2' }} ‡∏ø</span>
      </div>
      
      <!-- Payment information -->
      <div class="space-y-2 text-sm">
        <!-- PromptPay -->
        <div *ngIf="getPayerByName(t.to)?.promptpay" class="bg-white p-2 rounded border">
          <div class="flex items-center gap-2 mb-1">
            <span class="text-blue-600">üì±</span>
            <span class="font-medium text-gray-700">PromptPay</span>
          </div>
          <div class="text-gray-800 font-mono">{{ getPayerByName(t.to)?.promptpay }}</div>
        </div>
        
        <!-- SCB -->
        <div *ngIf="getPayerByName(t.to)?.scb" class="bg-white p-2 rounded border">
          <div class="flex items-center gap-2 mb-1">
            <span class="text-purple-600">üè¶</span>
            <span class="font-medium text-gray-700">SCB</span>
          </div>
          <div class="text-gray-800 font-mono">{{ getPayerByName(t.to)?.scb }}</div>
        </div>
        
        <!-- No payment info -->
        <div *ngIf="!getPayerByName(t.to)?.promptpay && !getPayerByName(t.to)?.scb" 
             class="text-gray-500 italic">
          ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô
        </div>
      </div>
    </div>
  </div>
</section>

  <!-- ‡πÅ‡∏ä‡∏£‡πå‡∏•‡∏¥‡∏á‡∏Å‡πå -->
  <section>
    <button
      (click)="shareLink()"
      class="w-full bg-blue-500 text-white py-3 rounded-xl font-medium hover:bg-blue-600 transition-colors"
    >
      üì§ ‡πÅ‡∏ä‡∏£‡πå‡∏•‡∏¥‡∏á‡∏Å‡πå
    </button>
  </section>

  <!-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ -->
  <section class="bg-white rounded-xl p-4 shadow-sm">
    <h2 class="font-medium mb-3 flex items-center gap-2">
      <span>üßæ</span>
      <span>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ</span>
    </h2>
    
    <div class="space-y-3">
      <input
        [(ngModel)]="testFrom"
        placeholder="‡∏à‡∏≤‡∏Å"
        class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
      <input
        [(ngModel)]="testTo"
        placeholder="‡∏ñ‡∏∂‡∏á"
        class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
      <input
        [(ngModel)]="testAmount"
        type="number"
        placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô"
        class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
      
      <button
        (click)="verifySlip()"
        class="w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition-colors"
      >
        ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
      </button>

      <div
        *ngIf="slipResult !== null"
        class="p-3 rounded-lg text-sm font-medium"
        [class]="slipResult ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'"
      >
        {{ slipResult ? '‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á' : '‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£' }}
      </div>
    </div>
  </section>

</main>